INFO 07-22 20:12:54 [__init__.py:243] Automatically detected platform cuda.
/root/rehan/mlperf-inference-5.1-redhat/language/llama3.1-8b/SUT_VLLM_SingleReplica.py:11: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  import pkg_resources
================================================================================
COMMAND LINE AND EXECUTABLE INFORMATION
================================================================================
Executable: /root/rehan/.venv/bin/python3
Command line: SUT_VLLM_SingleReplica.py --model_name meta-llama/Llama-3.1-8B --api-server-url http://0.0.0.0:8000 --batch_size 13368 --output-log-dir /root/rehan/src/mlperf_studies/study_11/baseline --dataset_path /root/rehan/datasets/cnn_eval.json
================================================================================
Current date and time: 2025-07-22 20:12:56
================================================================================
Installed Python packages:
  aiohappyeyeballs               2.6.1
  aiohttp                        3.12.7
  aiosignal                      1.3.2
  airportsdata                   20250523
  alembic                        1.16.1
  annotated-types                0.7.0
  anyio                          4.9.0
  astor                          0.8.1
  attrs                          25.3.0
  autocommand                    2.2.2
  backports.tarfile              1.2.0
  blake3                         1.0.5
  botorch                        0.9.5
  bottle                         0.13.3
  cachetools                     6.0.0
  certifi                        2025.4.26
  charset-normalizer             3.4.2
  choreographer                  1.0.9
  click                          8.1.8
  cloudpickle                    3.1.1
  colorama                       0.4.6
  colorlog                       6.9.0
  compressed-tensors             0.9.4
  contourpy                      1.3.2
  cupy-cuda12x                   13.4.1
  cycler                         0.12.1
  datasets                       3.6.0
  Deprecated                     1.2.18
  depyf                          0.18.0
  dill                           0.3.8
  diskcache                      5.6.3
  distro                         1.9.0
  dnspython                      2.7.0
  einops                         0.8.1
  email-validator                2.2.0
  fastapi                        0.115.12
  fastapi-cli                    0.0.7
  fastrlock                      0.8.3
  filelock                       3.18.0
  fonttools                      4.58.4
  frozenlist                     1.6.0
  fsspec                         2025.3.0
  ftfy                           6.3.1
  gguf                           0.17.0
  giturlparse                    0.12.0
  googleapis-common-protos       1.70.0
  gpytorch                       1.11
  greenlet                       3.2.2
  grpcio                         1.72.1
  guidellm                       0.1.0.dev0
  h11                            0.16.0
  h2                             4.2.0
  hf-xet                         1.1.2
  hpack                          4.1.0
  httpcore                       1.0.9
  httptools                      0.6.4
  httpx                          0.28.1
  huggingface-hub                0.32.4
  hyperframe                     6.1.0
  idna                           3.10
  importlib-metadata             8.6.1
  inflect                        7.3.1
  interegular                    0.3.3
  jaraco.collections             5.1.0
  jaraco.context                 5.3.0
  jaraco.functools               4.0.1
  jaraco.text                    3.12.1
  jaxtyping                      0.3.2
  jinja2                         3.1.6
  jiter                          0.10.0
  joblib                         1.5.1
  jsonschema                     4.24.0
  jsonschema-specifications      2025.4.1
  kaleido                        1.0.0
  kiwisolver                     1.4.8
  lark                           1.2.2
  linear-operator                0.5.1
  llguidance                     0.7.26
  llvmlite                       0.44.0
  lm-format-enforcer             0.10.11
  logistro                       1.1.0
  loguru                         0.7.3
  mako                           1.3.10
  markdown-it-py                 3.0.0
  MarkupSafe                     3.0.2
  matplotlib                     3.10.3
  mdurl                          0.1.2
  mistral-common                 1.5.6
  mlc-scripts                    1.0.2
  mlcflow                        1.0.18
  mlcommons-loadgen              5.0.25
  more-itertools                 10.3.0
  mpmath                         1.3.0
  msgpack                        1.1.0
  msgspec                        0.19.0
  multidict                      6.4.4
  multipledispatch               1.0.0
  multiprocess                   0.70.16
  mypy-extensions                1.1.0
  narwhals                       1.44.0
  nest-asyncio                   1.6.0
  networkx                       3.5
  ninja                          1.11.1.4
  numba                          0.61.2
  numpy                          2.2.6
  nvidia-cublas-cu12             12.6.4.1
  nvidia-cuda-cupti-cu12         12.6.80
  nvidia-cuda-nvrtc-cu12         12.6.77
  nvidia-cuda-runtime-cu12       12.6.77
  nvidia-cudnn-cu12              9.5.1.17
  nvidia-cufft-cu12              11.3.0.4
  nvidia-cufile-cu12             1.11.1.6
  nvidia-curand-cu12             10.3.7.77
  nvidia-cusolver-cu12           11.7.1.2
  nvidia-cusparse-cu12           12.5.4.2
  nvidia-cusparselt-cu12         0.6.3
  nvidia-nccl-cu12               2.26.2
  nvidia-nvjitlink-cu12          12.6.85
  nvidia-nvtx-cu12               12.6.77
  openai                         1.83.0
  opencv-python-headless         4.11.0.86
  opentelemetry-api              1.33.1
  opentelemetry-exporter-otlp    1.33.1
  opentelemetry-exporter-otlp-proto-common 1.33.1
  opentelemetry-exporter-otlp-proto-grpc 1.33.1
  opentelemetry-exporter-otlp-proto-http 1.33.1
  opentelemetry-proto            1.33.1
  opentelemetry-sdk              1.33.1
  opentelemetry-semantic-conventions 0.54b1
  opentelemetry-semantic-conventions-ai 0.4.9
  opt-einsum                     3.4.0
  optuna                         4.4.0
  optuna-dashboard               0.18.0
  optuna-integration             4.4.0
  orjson                         3.10.18
  outlines                       0.1.11
  outlines-core                  0.1.26
  packaging                      25.0
  panda                          0.3.1
  pandas                         2.3.0
  partial-json-parser            0.2.1.1.post5
  pillow                         11.2.1
  pip                            25.1.1
  platformdirs                   4.2.2
  plotly                         6.1.2
  prometheus-client              0.22.1
  prometheus-fastapi-instrumentator 7.1.0
  propcache                      0.3.1
  protobuf                       5.29.5
  psutil                         7.0.0
  py-cpuinfo                     9.0.0
  pyarrow                        20.0.0
  pybind11                       3.0.0
  pycountry                      24.6.1
  pydantic                       2.11.7
  pydantic-core                  2.33.2
  pydantic-settings              2.9.1
  pygments                       2.19.1
  pyparsing                      3.2.3
  pyre-extensions                0.0.32
  pyro-api                       0.1.2
  pyro-ppl                       1.9.1
  python-dateutil                2.9.0.post0
  python-dotenv                  1.1.0
  python-json-logger             3.3.0
  python-multipart               0.0.20
  pytz                           2025.2
  PyYAML                         6.0.2
  pyzmq                          26.4.0
  ray                            2.46.0
  referencing                    0.36.2
  regex                          2024.11.6
  requests                       2.32.3
  rich                           14.0.0
  rich-toolkit                   0.14.7
  rpds-py                        0.25.1
  safetensors                    0.5.3
  scikit-learn                   1.7.0
  scipy                          1.15.3
  seaborn                        0.13.2
  sentencepiece                  0.2.0
  setproctitle                   1.2.2
  setuptools                     79.0.1
  shellingham                    1.5.4
  simplejson                     3.20.1
  six                            1.17.0
  sniffio                        1.3.1INFO:root:--------------------------------------------------
INFO:root:Using vLLM API server at: http://0.0.0.0:8000
INFO:Llama-8B-Dataset:Loading dataset...
INFO:Llama-8B-Dataset:Finished loading dataset.
INFO:root:Dataset = 13368
INFO:root:Dataset Max = 2540
INFO:root:Dataset Min = 79
INFO:root:Dataset Len = 13368
INFO:root:Waiting for vLLM API server at http://0.0.0.0:8000 to be ready (timeout: 600s)...
INFO:root:vLLM API server at http://0.0.0.0:8000 is ready!
INFO:root:Tokenizer initialized for detokenization
INFO:root:MLPerf Loadgen: Starting test with 13368 samples in Offline mode...
INFO:root:Model: meta-llama/Llama-3.1-8B, Test Mode: performance
INFO:root:API SUT issue_query: Received 13368 queries from Loadgen. Batch size: 13368. Number of batches: 1.

  sqlalchemy                     2.0.41
  starlette                      0.46.2
  sympy                          1.14.0
  threadpoolctl                  3.6.0
  tiktoken                       0.9.0
  tokenizers                     0.21.1
  tomli                          2.0.1
  torch                          2.7.0
  torchaudio                     2.7.0
  torchvision                    0.22.0
  tqdm                           4.67.1
  transformers                   4.52.4
  triton                         3.3.0
  typeguard                      2.13.3
  typer                          0.16.0
  typing-extensions              4.14.0
  typing-inspect                 0.9.0
  typing-inspection              0.4.1
  tzdata                         2025.2
  urllib3                        2.4.0
  uvicorn                        0.34.3
  uvloop                         0.21.0
  vllm                           0.9.0.1
  wadler-lindig                  0.1.7
  watchfiles                     1.0.5
  wcwidth                        0.2.13
  websockets                     15.0.1
  wheel                          0.45.1
  wrapt                          1.17.2
  xformers                       0.0.30
  xgrammar                       0.1.19
  xxhash                         3.5.0
  yarl                           1.20.0
  zipp                           3.22.0
================================================================================

Set TORCH_CUDA_ARCH_LIST to 8.9
Traceback (most recent call last):
  File "/root/rehan/mlperf-inference-5.1-redhat/language/llama3.1-8b/SUT_VLLM_SingleReplica.py", line 810, in <module>
    lg.StartTestWithLogSettings(SUTToTest, qsl, settings, log_settings)
  File "/root/rehan/mlperf-inference-5.1-redhat/language/llama3.1-8b/SUT_VLLM_SingleReplica.py", line 498, in issue_query
    response = requests.post(self.completions_endpoint, json=api_payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/root/rehan/.venv/lib/python3.12/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/root/.local/share/uv/python/cpython-3.12.10-linux-x86_64-gnu/lib/python3.12/http/client.py", line 1430, in getresponse
    response.begin()
  File "/root/.local/share/uv/python/cpython-3.12.10-linux-x86_64-gnu/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/root/.local/share/uv/python/cpython-3.12.10-linux-x86_64-gnu/lib/python3.12/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/.local/share/uv/python/cpython-3.12.10-linux-x86_64-gnu/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
